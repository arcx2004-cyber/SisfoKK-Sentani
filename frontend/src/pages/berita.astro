---
import Layout from '../layouts/Layout.astro';
import { fetchNews, formatDate, getImageUrl } from '../lib/api';

// Fetch news from API
const news = await fetchNews();

// Fallback data if API returns empty
const displayNews = news.length > 0 ? news : [
  { id: 1, title: 'PPDB 2026/2027 Resmi Dibuka', slug: 'ppdb-2026', excerpt: 'Pendaftaran Peserta Didik Baru untuk tahun ajaran 2026/2027 telah resmi dibuka. Segera daftarkan putra-putri Anda untuk bergabung bersama keluarga besar Kalam Kudus Sentani.', image: 'https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400&h=200&fit=crop', published_at: '2026-01-12' },
  { id: 2, title: 'Siswa Raih Medali Olimpiade Sains', slug: 'olimpiade', excerpt: 'Siswa SMP Kalam Kudus berhasil meraih medali emas dalam Olimpiade Sains Nasional tingkat provinsi Papua. Prestasi gemilang ini membanggakan sekolah.', image: 'https://images.unsplash.com/photo-1577896851231-70ef18881754?w=400&h=200&fit=crop', published_at: '2026-01-08' },
  { id: 3, title: 'Perayaan Natal Bersama', slug: 'natal', excerpt: 'Seluruh civitas akademika merayakan Natal bersama dengan penuh sukacita. Acara diisi dengan ibadah, pentas seni, dan tukar kado.', image: 'https://images.unsplash.com/photo-1509062522246-3755977927d7?w=400&h=200&fit=crop', published_at: '2025-12-25' },
  { id: 4, title: 'Pelatihan Guru Kurikulum Merdeka', slug: 'pelatihan-guru', excerpt: 'Para guru mengikuti pelatihan intensif implementasi Kurikulum Merdeka untuk meningkatkan kualitas pembelajaran di sekolah.', image: 'https://images.unsplash.com/photo-1580582932707-520aed937b7b?w=400&h=200&fit=crop', published_at: '2025-11-25' },
  { id: 5, title: 'Penambahan Ekstrakurikuler Baru', slug: 'ekstrakurikuler', excerpt: 'Sekolah menambah beberapa kegiatan ekstrakurikuler baru seperti robotika, coding, dan musik modern untuk pengembangan bakat siswa.', image: 'https://images.unsplash.com/photo-1594608661623-aa0bd3a69d98?w=400&h=200&fit=crop', published_at: '2025-11-15' },
  { id: 6, title: 'Renovasi Perpustakaan Selesai', slug: 'perpustakaan', excerpt: 'Perpustakaan sekolah telah selesai direnovasi dengan fasilitas baru termasuk ruang baca digital dan koleksi buku yang diperbanyak.', image: 'https://images.unsplash.com/photo-1571260899304-425eee4c7efc?w=400&h=200&fit=crop', published_at: '2025-11-01' },
];
---

<Layout title="Berita">
  <section class="hero" style="min-height: 300px;">
    <div class="hero-content">
      <span class="hero-badge">ðŸ“° Informasi</span>
      <h1 class="hero-title">Berita Sekolah</h1>
      <p class="hero-subtitle">Kabar terbaru seputar kegiatan dan prestasi Sekolah Kalam Kudus</p>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="grid grid-3">
        {displayNews.map((item) => (
          <article class="news-card">
            <img src={getImageUrl(item.image, 'https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400&h=200&fit=crop')} alt={item.title} />
            <div class="news-card-content">
              <span class="news-card-date">{formatDate(item.published_at)}</span>
              <h3 class="news-card-title">{item.title}</h3>
              <p class="news-card-excerpt">{item.excerpt || item.title}</p>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>
</Layout>
