---
import Layout from '../layouts/Layout.astro';
import { fetchUnits, getUnitIcon } from '../lib/api';

// Fetch units from API
const units = await fetchUnits();

// Fallback data if API returns empty
const displayUnits = units.length > 0 ? units : [
  { id: 1, nama: 'TK Kalam Kudus', kode: 'TK', deskripsi: 'Pendidikan Anak Usia Dini dengan pendekatan bermain sambil belajar dalam suasana kasih Kristus.', is_active: true, urutan: 1 },
  { id: 2, nama: 'SD Kalam Kudus', kode: 'SD', deskripsi: 'Pendidikan Dasar 6 tahun dengan kurikulum terpadu dan pembentukan karakter Kristiani.', is_active: true, urutan: 2 },
  { id: 3, nama: 'SMP Kalam Kudus', kode: 'SMP', deskripsi: 'Pendidikan Menengah Pertama dengan pengembangan akademik dan life skills.', is_active: true, urutan: 3 },
];

// Unit features based on kode
function getUnitFeatures(kode: string): string[] {
  const features: Record<string, string[]> = {
    'TK': ['Usia 4-6 tahun', 'Kurikulum PAUD Merdeka', 'Pendidikan Karakter Kristiani', 'Kegiatan Ekstrakurikuler'],
    'SD': ['Kelas 1-6', 'Kurikulum Merdeka', 'Pembelajaran Aktif & Kreatif', 'Laboratorium & Perpustakaan'],
    'SMP': ['Kelas 7-9', 'Kurikulum Merdeka', 'Bimbingan Konseling', 'Persiapan Masa Depan'],
  };
  return features[kode] || ['Kurikulum Merdeka', 'Pendidikan Karakter'];
}
---

<Layout title="Unit Pendidikan">
  <section class="hero" style="min-height: 300px;">
    <div class="hero-content">
      <span class="hero-badge">ğŸ« Jenjang Pendidikan</span>
      <h1 class="hero-title">Unit Pendidikan</h1>
      <p class="hero-subtitle">Tiga jenjang pendidikan berkualitas berbasis iman Kristiani</p>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="grid grid-3">
        {displayUnits.map((unit) => (
          <div class="unit-card">
            <div class="unit-icon">{getUnitIcon(unit.kode)}</div>
            <h3 class="unit-name">{unit.nama}</h3>
            <p class="unit-desc">{unit.deskripsi || `Unit ${unit.nama} Sekolah Kalam Kudus Sentani`}</p>
            <ul style="text-align: left; margin: 1.5rem 0; color: var(--gray-600);">
              {getUnitFeatures(unit.kode).map((feature) => (
                <li>{feature}</li>
              ))}
            </ul>
            <div class="unit-buttons">
              <a href={`/unit/${unit.kode.toLowerCase()}`} class="btn btn-outline">Lihat Detail</a>
              <a href="/ppdb" class="btn btn-primary">Daftar Sekarang</a>
            </div>
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="cta">
    <div class="container">
      <h2 class="cta-title">Bergabung Bersama Kami</h2>
      <p class="cta-desc">Daftarkan putra-putri Anda untuk mendapatkan pendidikan terbaik</p>
      <a href="/ppdb" class="btn">Daftar PPDB</a>
    </div>
  </section>

  <style>
    .unit-buttons {
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    .unit-buttons .btn {
      font-size: 0.9rem;
      padding: 0.6rem 1.2rem;
    }
  </style>
</Layout>
