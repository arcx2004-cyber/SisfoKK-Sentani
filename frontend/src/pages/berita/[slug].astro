---
import Layout from '../../layouts/Layout.astro';
import { fetchNews, fetchNewsDetail, formatDate, getImageUrl } from '../../lib/api';

export async function getStaticPaths() {
  const news = await fetchNews();
  return news.map((item) => ({
    params: { slug: item.slug },
  }));
}

const { slug } = Astro.params;
const news = await fetchNewsDetail(slug);

if (!news) {
  return Astro.redirect('/404');
}
---

<Layout title={news.judul}>
  <section class=hero style={`background-image: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), url('${getImageUrl(news.featured_image, '')}'); min-height: 400px; background-size: cover; background-position: center;`}>
    <div class=hero-content>
      <span class=hero-badge>{formatDate(news.published_at)}</span>
      <h1 class=hero-title>{news.judul}</h1>
    </div>
  </section>

  <section class=section>
    <div class=container>
      <article class=prose max-w-3xl mx-auto page-content set:html={news.konten} />
      
      <div class=text-center mt-8 style=margin-top: 3rem;>
        <a href=/berita class=btn btn-outline>‚Üê Kembali ke Berita</a>
      </div>
    </div>
  </section>

  <style>
    .page-content :global(h1), .page-content :global(h2), .page-content :global(h3) {
      color: var(--primary-800); margin-top: 1.5rem; margin-bottom: 1rem;
    }
    .page-content :global(p) {
      color: var(--gray-600); line-height: 1.8; margin-bottom: 1.5rem; font-size: 1.1rem;
    }
    .page-content :global(img) {
      border-radius: var(--radius); margin: 1.5rem 0; max-width: 100%;
    }
  </style>
</Layout>
